@prefix dc:    <http://purl.org/dc/elements/1.1/> .
@prefix need:  <http://localhost:8080/won/resource/need/> .
@prefix rdfs:  <http://www.w3.org/2000/01/rdf-schema#> .
@prefix geo:   <http://www.w3.org/2003/01/geo/wgs84_pos#> .
@prefix conn:  <http://localhost:8080/won/resource/connection/> .
@prefix event: <http://localhost:8080/won/resource/event/> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .
@prefix rdf:   <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix won:   <http://purl.org/webofneeds/model#> .
@prefix local: <http://localhost:8080/won/resource/> .
@prefix msg:   <http://purl.org/webofneeds/message#> .
@prefix ldp:   <http://www.w3.org/ns/ldp#> .
@prefix signature: <http://icp.it-risk.iwvi.uni-koblenz.de/ontologies/signature.owl#> .
@prefix cert: <http://www.w3.org/ns/auth/cert#> .
@prefix woncrypt:   <http://purl.org/webofneeds/woncrypt#> .



# NEED DATA GRAPH
<http://localhost:8080/won/resource/need/3144709509622353000/core/#data>
{
    need:3144709509622353000
            a                     won:Need ;
            won:hasBasicNeedType  won:Supply ;
            won:hasContent        [ a                          won:NeedContent ;
                                    dc:title                   "salat offer a" ;
                                    won:hasContentDescription  [ a                             won:NeedModality ;
                                                                 won:hasLocationSpecification  [ a               geo:Point ;
                                                                                                 won:hasAddress  "" ;
                                                                                                 geo:latitude    "0.000000"^^xsd:float ;
                                                                                                 geo:longitude   "0.000000"
                                                                                               ]
                                                               ] ;
                                    won:hasTag                 "aaa" ;
                                    won:hasTextDescription     "a"
                                  ] ;
            won:hasFacet          won:OwnerFacet ;
            cert:key [ cert:PublicKey
                                [
                                    a woncrypt:ECCPublicKey ;
                                    woncrypt:ecc_curveId "brainpoolp384r1" ;
                                    woncrypt:ecc_algorithm "EC" ;
                                    woncrypt:ecc_qx "26de01d3bc95b7de3f50f813f0e25fc7e3334802d76594350d024f3b78d682eab6422b4285ddfa69b65deac5b063c058" ;
                                    woncrypt:ecc_qy "5871bd0f6065bf6786dccc4f658b1aad83e3b22ac4dd65d480322fec2b94f8b175eeb02bd34a6c0a1526c29371164dd6" ;
                                ]
            ] .
}

#  NEED DATA GRAPH SIGNATURE
<http://localhost:8080/won/resource/need/3144709509622353000/core/#data-sig>
{
<http://localhost:8080/won/resource/need/3144709509622353000/core/#data-sig>
          a                            signature:Signature ;
          msg:hasSignedGraph <http://localhost:8080/won/resource/need/3144709509622353000/core/#data> ;
          signature:hasGraphSigningMethod
                  [ a                               signature:GraphSigningMethod ;
                    signature:hasDigestMethod       signature:dm-sha-256 ;
                    signature:hasGraphCanonicalizationMethod
                            signature:gcm-fisteus-2010 ;
                    signature:hasGraphDigestMethod  signature:gdm-fisteus-2010 ;
                    signature:hasGraphSerializationMethod
                            signature:gsm-trig ;
                    signature:hasSignatureMethod    signature:sm-ecdsa
                  ] ;
          signature:hasSignatureValue
                  "MGQCMGyNqqqX51QXHlUYMmVDNs83veBQvwBO7W3BlYn5CVbStS9v/WfQJRvf4aCmZHDvgAIwM78j\r\nRg5x0Vu42Odi3U4R0AYBKmnzO0Db537Cc6uFWoNeBleqw259xxwOlpozMHfr" ;
          signature:hasVerificationCertificate
                  <http://localhost:8080/won/resource/need/3144709509622353000>  .
}




# 1st ENVELOPE GRAPH
<http://localhost:8080/won/resource/event/7719577021233193000#data>
{
    <http://localhost:8080/won/resource/event/7719577021233193000#data>
            a       msg:EnvelopeGraph ;
            <http://www.w3.org/2004/03/trix/rdfg-1/subGraphOf>
                    event:7719577021233193000 .

    event:7719577021233193000
            a                    msg:OwnerToNodeEnvelope ;
            msg:hasContent       <http://localhost:8080/won/resource/need/3144709509622353000/core/#data> ;

            msg:referencesSignature     [
                msg:hasSignedGraph <http://localhost:8080/won/resource/need/3144709509622353000/core/#data> ;
                msg:hasSignatureValue "MGQCMGyNqqqX51QXHlUYMmVDNs83veBQvwBO7W3BlYn5CVbStS9v/WfQJRvf4aCmZHDvgAIwM78j\r\nRg5x0Vu42Odi3U4R0AYBKmnzO0Db537Cc6uFWoNeBleqw259xxwOlpozMHfr" ;
                msg:hasSignatureGraph <http://localhost:8080/won/resource/need/3144709509622353000/core/#data-sig>
            ] ;

            msg:hasMessageType   msg:CreateMessage ;
            msg:hasReceiverNode  <http://localhost:8080/won/resource> ;
            msg:hasSenderNeed    need:3144709509622353000 .
}

# 1st ENVELOPE GRAPH SIGNATURE
<http://localhost:8080/won/resource/event/7719577021233193000#data-sig>
{
    <http://localhost:8080/won/resource/event/7719577021233193000#data-sig>
              a                            signature:Signature ;
              msg:hasSignedGraph <http://localhost:8080/won/resource/event/7719577021233193000#data> ;
              signature:hasGraphSigningMethod
                      [ a                               signature:GraphSigningMethod ;
                        signature:hasDigestMethod       signature:dm-sha-256 ;
                        signature:hasGraphCanonicalizationMethod
                                signature:gcm-fisteus-2010 ;
                        signature:hasGraphDigestMethod  signature:gdm-fisteus-2010 ;
                        signature:hasGraphSerializationMethod
                                signature:gsm-trig ;
                        signature:hasSignatureMethod    signature:sm-ecdsa
                      ] ;
              signature:hasSignatureValue  "MGQCME+PugatzrSYuM++Se06b32fNvuilsHP/+7M4wbyzE3RVIzGDzVUmCLijp3ahayCHAIwGikN\r\nAXqoz8+5K2WfQq7kvBX/thMEzYmtiGwUfhUg5VwXUjLHkyww95YMtpaqQ6DG" ;
              signature:hasVerificationCertificate
                      <http://localhost:8080/won/resource/need/3144709509622353000> .
}




# 2nd ENVELOPE GRAPH
<http://localhost:8080/won/resource/event/7719577021233193000#envelope-s7gl>
{
    <http://localhost:8080/won/resource/event/7719577021233193000#envelope-s7gl>
            a                     msg:EnvelopeGraph ;
            msg:containsEnvelope  <http://localhost:8080/won/resource/event/7719577021233193000#data> ;
            <http://www.w3.org/2004/03/trix/rdfg-1/subGraphOf>
                    event:7719577021233193000 .
    
    event:7719577021233193000
            a                 msg:NodeToNodeEnvelope ;

            msg:referencesSignature     [
                            msg:hasSignedGraph <http://localhost:8080/won/resource/event/7719577021233193000#data> ;
                            msg:hasSignatureValue "MGQCME+PugatzrSYuM++Se06b32fNvuilsHP/+7M4wbyzE3RVIzGDzVUmCLijp3ahayCHAIwGikN\r\nAXqoz8+5K2WfQq7kvBX/thMEzYmtiGwUfhUg5VwXUjLHkyww95YMtpaqQ6DG" ;
                            msg:hasSignatureGraph <http://localhost:8080/won/resource/event/7719577021233193000#data-sig>
                        ] ;

            msg:hasTimestamp  "1426858925851"^^xsd:long .

}

# 2nd ENVELOPE GRAPH SIGNATURE
<http://localhost:8080/won/resource/event/7719577021233193000#envelope-s7gl-sig>
{
    <http://localhost:8080/won/resource/event/7719577021233193000#envelope-s7gl-sig>
              a                            signature:Signature ;
              msg:hasSignedGraph <http://localhost:8080/won/resource/event/7719577021233193000#envelope-s7gl> ;
              signature:hasGraphSigningMethod
                      [ a                               signature:GraphSigningMethod ;
                        signature:hasDigestMethod       signature:dm-sha-256 ;
                        signature:hasGraphCanonicalizationMethod
                                signature:gcm-fisteus-2010 ;
                        signature:hasGraphDigestMethod  signature:gdm-fisteus-2010 ;
                        signature:hasGraphSerializationMethod
                                signature:gsm-trig ;
                        signature:hasSignatureMethod    signature:sm-ecdsa
                      ] ;
              signature:hasSignatureValue  "MGQCMBQeADC8WyHtdJje9r8z2ihLCiadO//8nM+gwIEUWEpdrRKN97VXo7vEVMjbKBDvWgIwb+qO\r\n+xAnDq1TToTBY5yOy1rjhJjYW0lIVrCNyY1Txem/2z+DrWRExDsFSN7EpnXu" ;
              signature:hasVerificationCertificate
                      <http://localhost:8080/node/certificate> .
}
